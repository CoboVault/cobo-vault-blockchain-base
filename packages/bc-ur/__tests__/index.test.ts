import { encodeUR, decodeUR, extractSingleWorkload } from '../src';

describe('bc-ur', () => {
    it('should encode ur', () => {
        const random =
            '7e4a61385e2550981b4b5633ab178eb077a30505fbd53f107ec1081e7cf0ca3c0dc0bfea5b8bfb5e6ffc91afd104c3aa756210b5dbc5118fd12c87ee04269815ba6a9968a0d0d3b7a9b631382a36bc70ab626d5670b4b48ff843f4d9a15631aa67c7aaf0ac6ce7e3bff03b2c9643e3375e47493c4e0f8635329d66fdec41b10ce74dcbf25fc15d829e7830c325643a98561f441b40a02e8353493e6afc16192fe99d90d8ca65539af77ddeaccc8943a37563a9ba83675bd5d4da7c60c9a172cf6940cbf0ec8fe04175a629932e3512c5d2aaea3cca3246f40a21ffdc33c3987dc7b880351230eb3759fe3c7dc7b2d3a20a95996ff0b7a0dba834f96beb64c14e3426fb051a936ba41569ab99c0066a6d9c0777a49e49e6cbad24d722a4c7da112432679264b9adc0a8cff9dd1fe0ee9ee2747f6a68537c389a7303a1af23c534ee6392bc17b04cf0fbce7689e66b673a440c04a9454005b0c76664639113458eb7d0902eff04d11138ce2a8ee16a9cd7c8926514efa9bd83ae7a4c139835f0fe0f68c628e0645c8524c30dfc314e825a7aa13224d98e2f7a9d12183a999bb1f28549c99a9072d99c05c24e0c84848c4fc147a094ab7b69e9cbea86952fccf15500fbb234ffe6ee6e6ded515c8016cb017ba36fb931ef276cec4ed22c1aed1495d2df3b3ce66c03f5b9ffa8434bf0e8fb149de94e050b3da178df1f76c00a366cb2801fabdf1a1e90cd3cd45ecb7a930a40b151455f76b726d552f31c21324992da257ff8bde2923dfd5d0d6b87233fae215ffacbecd96249099e7e3427d533db56cdb09c7475b4ce3314e33f43953a7370866cc11d85f00b71b15510b46c4b4fa490c660ddfeda0ceb1b8265995f7071c155ad1b57465fdc0fa81a73f9f19ac4872029d5844c1838f732e803043673e26cbc5b51297a324ff00a2d2d4222bad556b93d27c8e376e3ff8f9d37b3073410708ebb3d4dd7473d27212310b71a3c33a5c8f87f44824640e7f8970f4eda9364195c87a91172b8f085f1773641dde1ce21938746234055bc971ce2325f814e3eec60f781dd4faf52afd5be4a6b38656f7e9739f724cb7ccd4e4d01e802add3dc7b83191f894b3ee0ed752ee514d5ec55';
        expect(encodeUR(random)).toStrictEqual([
            'UR:BYTES/1OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
            'UR:BYTES/2OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/VM77CSD3PNN5MJLJTLQ4MQ570QCVXFTY82V9V86YRDQ2QT5R2DYNU6HUZCVJL6VAJRVV5E2NNTMHMH4VEJY58GM4VW5M4QM8T02AFKNUVRY6ZUK0D9QVHU8V3LSYZADX9XFJUDGJCHF2463UEGEYDAQ2Y8LACV7RNP7U0WYQX5FRP6EHT8LRCLW8KTF6YZ54N9HLPDAQ',
            'UR:BYTES/3OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/MW5RF7TTADJVZN35YMAS2X5NDWJP26DTN8QQV6NDNSRH0FY7F8NVHTFY6U32F376ZYJRYEUJVJU6MS9GELUA68LQA60WYARLDF59XLPCNFES8GD0Y0ZNFMNRJ27P0VZV7RAUUA5FUE4KWWJYPSZ2J32QQKCVWENYVWG3X3VWKLGFQTHLQNG3ZWXW928WZ65U6LYFYEG5',
            'UR:BYTES/4OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/A75MMQAW0FXP8XP47RLQ76XX9RSXGHY9YNPSMLP3F6P9574PXGJDNR3002W3YXP6NXDMRU59F8YE4YRJMXWQTSJWPJZGFRZ0C9R6P99T0D57NJL2S62JLN8325Q0HV35LLNWUMNDA4G4EQQKEVQHHGM0HYC77FMVA38DYTQ6A52FT5KL8V7WVMQR7KULL2ZRF0CW37C5',
            'UR:BYTES/5OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/NH55UPGT8KSH3HCLWMQQ5DNVK2QPL27LRG0FPNFU630VK75NPFQTZ529TAMTWFK42TE3CGFJFXFD5FTLLZ779Y3AL4WS66U8YVL6UG2LLT97EKTZFYYEUL35YL2N8K6KEKCFCAR4KN8RX98R8APE2WNNWZRXESGASHCQKUD325GTGMZTF7JFP3NQMHLD5R8TRWPXTX2L',
            'UR:BYTES/6OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/WPCUZ4DDRDT5VH7UP75P5ULE7XDVFPEQ982CGNQC8RMN96QRQSM88CNVH3D4Z2T6XF8LQZ3D94PZ9WK426UN6F7GUDMW8LU0N5MMXPE5ZPCGAWEAFHT5W0F8YY33PDC68SE6TJ8C0AZGY3JQULUFWR6WM2FKGX2US753ZU4C7ZZLZAEKG8W7RN3PJWR5VG6Q2K7FW88Z',
            'UR:BYTES/7OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/XF0CZN37A3S00QWAF7H49T74HE9XKWR9DALFWW0HYN9HEN2WF5Q7SQ4D60W8HQCER7Y5K0HQA46JAEG56HK92XD0VZ4',
        ]);
    });
    it('should encode payload does not need to split', () => {
        const random = '7e4a61385e2550981b4b5633ab178eb077a30505fb';
        expect(encodeUR(random)).toStrictEqual(['UR:BYTES/24LY5CFCTCJ4PXQMFDTR82CH36C80GC9QHASMXDXS3']);
    });

    it('should decode ur with multiple workloads', () => {
        const workloads = [
            'UR:BYTES/1OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
            'UR:BYTES/2OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/VM77CSD3PNN5MJLJTLQ4MQ570QCVXFTY82V9V86YRDQ2QT5R2DYNU6HUZCVJL6VAJRVV5E2NNTMHMH4VEJY58GM4VW5M4QM8T02AFKNUVRY6ZUK0D9QVHU8V3LSYZADX9XFJUDGJCHF2463UEGEYDAQ2Y8LACV7RNP7U0WYQX5FRP6EHT8LRCLW8KTF6YZ54N9HLPDAQ',
            'UR:BYTES/3OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/MW5RF7TTADJVZN35YMAS2X5NDWJP26DTN8QQV6NDNSRH0FY7F8NVHTFY6U32F376ZYJRYEUJVJU6MS9GELUA68LQA60WYARLDF59XLPCNFES8GD0Y0ZNFMNRJ27P0VZV7RAUUA5FUE4KWWJYPSZ2J32QQKCVWENYVWG3X3VWKLGFQTHLQNG3ZWXW928WZ65U6LYFYEG5',
            'UR:BYTES/4OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/A75MMQAW0FXP8XP47RLQ76XX9RSXGHY9YNPSMLP3F6P9574PXGJDNR3002W3YXP6NXDMRU59F8YE4YRJMXWQTSJWPJZGFRZ0C9R6P99T0D57NJL2S62JLN8325Q0HV35LLNWUMNDA4G4EQQKEVQHHGM0HYC77FMVA38DYTQ6A52FT5KL8V7WVMQR7KULL2ZRF0CW37C5',
            'UR:BYTES/5OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/NH55UPGT8KSH3HCLWMQQ5DNVK2QPL27LRG0FPNFU630VK75NPFQTZ529TAMTWFK42TE3CGFJFXFD5FTLLZ779Y3AL4WS66U8YVL6UG2LLT97EKTZFYYEUL35YL2N8K6KEKCFCAR4KN8RX98R8APE2WNNWZRXESGASHCQKUD325GTGMZTF7JFP3NQMHLD5R8TRWPXTX2L',
            'UR:BYTES/6OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/WPCUZ4DDRDT5VH7UP75P5ULE7XDVFPEQ982CGNQC8RMN96QRQSM88CNVH3D4Z2T6XF8LQZ3D94PZ9WK426UN6F7GUDMW8LU0N5MMXPE5ZPCGAWEAFHT5W0F8YY33PDC68SE6TJ8C0AZGY3JQULUFWR6WM2FKGX2US753ZU4C7ZZLZAEKG8W7RN3PJWR5VG6Q2K7FW88Z',
            'UR:BYTES/7OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/XF0CZN37A3S00QWAF7H49T74HE9XKWR9DALFWW0HYN9HEN2WF5Q7SQ4D60W8HQCER7Y5K0HQA46JAEG56HK92XD0VZ4',
        ];
        expect(decodeUR(workloads)).toBe(
            '7e4a61385e2550981b4b5633ab178eb077a30505fbd53f107ec1081e7cf0ca3c0dc0bfea5b8bfb5e6ffc91afd104c3aa756210b5dbc5118fd12c87ee04269815ba6a9968a0d0d3b7a9b631382a36bc70ab626d5670b4b48ff843f4d9a15631aa67c7aaf0ac6ce7e3bff03b2c9643e3375e47493c4e0f8635329d66fdec41b10ce74dcbf25fc15d829e7830c325643a98561f441b40a02e8353493e6afc16192fe99d90d8ca65539af77ddeaccc8943a37563a9ba83675bd5d4da7c60c9a172cf6940cbf0ec8fe04175a629932e3512c5d2aaea3cca3246f40a21ffdc33c3987dc7b880351230eb3759fe3c7dc7b2d3a20a95996ff0b7a0dba834f96beb64c14e3426fb051a936ba41569ab99c0066a6d9c0777a49e49e6cbad24d722a4c7da112432679264b9adc0a8cff9dd1fe0ee9ee2747f6a68537c389a7303a1af23c534ee6392bc17b04cf0fbce7689e66b673a440c04a9454005b0c76664639113458eb7d0902eff04d11138ce2a8ee16a9cd7c8926514efa9bd83ae7a4c139835f0fe0f68c628e0645c8524c30dfc314e825a7aa13224d98e2f7a9d12183a999bb1f28549c99a9072d99c05c24e0c84848c4fc147a094ab7b69e9cbea86952fccf15500fbb234ffe6ee6e6ded515c8016cb017ba36fb931ef276cec4ed22c1aed1495d2df3b3ce66c03f5b9ffa8434bf0e8fb149de94e050b3da178df1f76c00a366cb2801fabdf1a1e90cd3cd45ecb7a930a40b151455f76b726d552f31c21324992da257ff8bde2923dfd5d0d6b87233fae215ffacbecd96249099e7e3427d533db56cdb09c7475b4ce3314e33f43953a7370866cc11d85f00b71b15510b46c4b4fa490c660ddfeda0ceb1b8265995f7071c155ad1b57465fdc0fa81a73f9f19ac4872029d5844c1838f732e803043673e26cbc5b51297a324ff00a2d2d4222bad556b93d27c8e376e3ff8f9d37b3073410708ebb3d4dd7473d27212310b71a3c33a5c8f87f44824640e7f8970f4eda9364195c87a91172b8f085f1773641dde1ce21938746234055bc971ce2325f814e3eec60f781dd4faf52afd5be4a6b38656f7e9739f724cb7ccd4e4d01e802add3dc7b83191f894b3ee0ed752ee514d5ec55',
        );
    });

    it('should decode ur with random order', () => {
        const workloads = [
            'UR:BYTES/7OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/XF0CZN37A3S00QWAF7H49T74HE9XKWR9DALFWW0HYN9HEN2WF5Q7SQ4D60W8HQCER7Y5K0HQA46JAEG56HK92XD0VZ4',
            'UR:BYTES/4OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/A75MMQAW0FXP8XP47RLQ76XX9RSXGHY9YNPSMLP3F6P9574PXGJDNR3002W3YXP6NXDMRU59F8YE4YRJMXWQTSJWPJZGFRZ0C9R6P99T0D57NJL2S62JLN8325Q0HV35LLNWUMNDA4G4EQQKEVQHHGM0HYC77FMVA38DYTQ6A52FT5KL8V7WVMQR7KULL2ZRF0CW37C5',
            'UR:BYTES/2OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/VM77CSD3PNN5MJLJTLQ4MQ570QCVXFTY82V9V86YRDQ2QT5R2DYNU6HUZCVJL6VAJRVV5E2NNTMHMH4VEJY58GM4VW5M4QM8T02AFKNUVRY6ZUK0D9QVHU8V3LSYZADX9XFJUDGJCHF2463UEGEYDAQ2Y8LACV7RNP7U0WYQX5FRP6EHT8LRCLW8KTF6YZ54N9HLPDAQ',
            'UR:BYTES/5OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/NH55UPGT8KSH3HCLWMQQ5DNVK2QPL27LRG0FPNFU630VK75NPFQTZ529TAMTWFK42TE3CGFJFXFD5FTLLZ779Y3AL4WS66U8YVL6UG2LLT97EKTZFYYEUL35YL2N8K6KEKCFCAR4KN8RX98R8APE2WNNWZRXESGASHCQKUD325GTGMZTF7JFP3NQMHLD5R8TRWPXTX2L',
            'UR:BYTES/3OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/MW5RF7TTADJVZN35YMAS2X5NDWJP26DTN8QQV6NDNSRH0FY7F8NVHTFY6U32F376ZYJRYEUJVJU6MS9GELUA68LQA60WYARLDF59XLPCNFES8GD0Y0ZNFMNRJ27P0VZV7RAUUA5FUE4KWWJYPSZ2J32QQKCVWENYVWG3X3VWKLGFQTHLQNG3ZWXW928WZ65U6LYFYEG5',
            'UR:BYTES/6OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/WPCUZ4DDRDT5VH7UP75P5ULE7XDVFPEQ982CGNQC8RMN96QRQSM88CNVH3D4Z2T6XF8LQZ3D94PZ9WK426UN6F7GUDMW8LU0N5MMXPE5ZPCGAWEAFHT5W0F8YY33PDC68SE6TJ8C0AZGY3JQULUFWR6WM2FKGX2US753ZU4C7ZZLZAEKG8W7RN3PJWR5VG6Q2K7FW88Z',
            'UR:BYTES/1OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
        ];
        expect(decodeUR(workloads)).toBe(
            '7e4a61385e2550981b4b5633ab178eb077a30505fbd53f107ec1081e7cf0ca3c0dc0bfea5b8bfb5e6ffc91afd104c3aa756210b5dbc5118fd12c87ee04269815ba6a9968a0d0d3b7a9b631382a36bc70ab626d5670b4b48ff843f4d9a15631aa67c7aaf0ac6ce7e3bff03b2c9643e3375e47493c4e0f8635329d66fdec41b10ce74dcbf25fc15d829e7830c325643a98561f441b40a02e8353493e6afc16192fe99d90d8ca65539af77ddeaccc8943a37563a9ba83675bd5d4da7c60c9a172cf6940cbf0ec8fe04175a629932e3512c5d2aaea3cca3246f40a21ffdc33c3987dc7b880351230eb3759fe3c7dc7b2d3a20a95996ff0b7a0dba834f96beb64c14e3426fb051a936ba41569ab99c0066a6d9c0777a49e49e6cbad24d722a4c7da112432679264b9adc0a8cff9dd1fe0ee9ee2747f6a68537c389a7303a1af23c534ee6392bc17b04cf0fbce7689e66b673a440c04a9454005b0c76664639113458eb7d0902eff04d11138ce2a8ee16a9cd7c8926514efa9bd83ae7a4c139835f0fe0f68c628e0645c8524c30dfc314e825a7aa13224d98e2f7a9d12183a999bb1f28549c99a9072d99c05c24e0c84848c4fc147a094ab7b69e9cbea86952fccf15500fbb234ffe6ee6e6ded515c8016cb017ba36fb931ef276cec4ed22c1aed1495d2df3b3ce66c03f5b9ffa8434bf0e8fb149de94e050b3da178df1f76c00a366cb2801fabdf1a1e90cd3cd45ecb7a930a40b151455f76b726d552f31c21324992da257ff8bde2923dfd5d0d6b87233fae215ffacbecd96249099e7e3427d533db56cdb09c7475b4ce3314e33f43953a7370866cc11d85f00b71b15510b46c4b4fa490c660ddfeda0ceb1b8265995f7071c155ad1b57465fdc0fa81a73f9f19ac4872029d5844c1838f732e803043673e26cbc5b51297a324ff00a2d2d4222bad556b93d27c8e376e3ff8f9d37b3073410708ebb3d4dd7473d27212310b71a3c33a5c8f87f44824640e7f8970f4eda9364195c87a91172b8f085f1773641dde1ce21938746234055bc971ce2325f814e3eec60f781dd4faf52afd5be4a6b38656f7e9739f724cb7ccd4e4d01e802add3dc7b83191f894b3ee0ed752ee514d5ec55',
        );
    });

    it('should decode ur with single workload', () => {
        expect(decodeUR(['UR:BYTES/24LY5CFCTCJ4PXQMFDTR82CH36C80GC9QHASMXDXS3'])).toStrictEqual(
            '7e4a61385e2550981b4b5633ab178eb077a30505fb',
        );
    });

    it('should throw error with single invalid workload', () => {
        expect(() => {
            decodeUR(['UR:AMD/24LY5CFCTCJ4PXQMFDTR82CH36C80GC9QHASMXDXS3']);
        }).toThrow();
        expect(() => {
            decodeUR(['UR:BYTES/DIGEST/24LY5CFCTCJ4PXQMFDTR82CH36C80GC9QHASMXDXS3']);
        }).toThrow();
    });

    describe('should throw error with multiple invalid workloads', () => {
        it('invalid index', () => {
            expect(() => {
                decodeUR([
                    'UR:BYTES/1OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
                    'UR:BYTES/1OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/VM77CSD3PNN5MJLJTLQ4MQ570QCVXFTY82V9V86YRDQ2QT5R2DYNU6HUZCVJL6VAJRVV5E2NNTMHMH4VEJY58GM4VW5M4QM8T02AFKNUVRY6ZUK0D9QVHU8V3LSYZADX9XFJUDGJCHF2463UEGEYDAQ2Y8LACV7RNP7U0WYQX5FRP6EHT8LRCLW8KTF6YZ54N9HLPDAQ',
                    'UR:BYTES/3OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/MW5RF7TTADJVZN35YMAS2X5NDWJP26DTN8QQV6NDNSRH0FY7F8NVHTFY6U32F376ZYJRYEUJVJU6MS9GELUA68LQA60WYARLDF59XLPCNFES8GD0Y0ZNFMNRJ27P0VZV7RAUUA5FUE4KWWJYPSZ2J32QQKCVWENYVWG3X3VWKLGFQTHLQNG3ZWXW928WZ65U6LYFYEG5',
                    'UR:BYTES/4OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/A75MMQAW0FXP8XP47RLQ76XX9RSXGHY9YNPSMLP3F6P9574PXGJDNR3002W3YXP6NXDMRU59F8YE4YRJMXWQTSJWPJZGFRZ0C9R6P99T0D57NJL2S62JLN8325Q0HV35LLNWUMNDA4G4EQQKEVQHHGM0HYC77FMVA38DYTQ6A52FT5KL8V7WVMQR7KULL2ZRF0CW37C5',
                    'UR:BYTES/5OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/NH55UPGT8KSH3HCLWMQQ5DNVK2QPL27LRG0FPNFU630VK75NPFQTZ529TAMTWFK42TE3CGFJFXFD5FTLLZ779Y3AL4WS66U8YVL6UG2LLT97EKTZFYYEUL35YL2N8K6KEKCFCAR4KN8RX98R8APE2WNNWZRXESGASHCQKUD325GTGMZTF7JFP3NQMHLD5R8TRWPXTX2L',
                    'UR:BYTES/6OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/WPCUZ4DDRDT5VH7UP75P5ULE7XDVFPEQ982CGNQC8RMN96QRQSM88CNVH3D4Z2T6XF8LQZ3D94PZ9WK426UN6F7GUDMW8LU0N5MMXPE5ZPCGAWEAFHT5W0F8YY33PDC68SE6TJ8C0AZGY3JQULUFWR6WM2FKGX2US753ZU4C7ZZLZAEKG8W7RN3PJWR5VG6Q2K7FW88Z',
                    'UR:BYTES/7OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/XF0CZN37A3S00QWAF7H49T74HE9XKWR9DALFWW0HYN9HEN2WF5Q7SQ4D60W8HQCER7Y5K0HQA46JAEG56HK92XD0VZ4',
                ]);
            }).toThrow();
        });
        it('missing piece', () => {
            expect(() => {
                decodeUR([
                    'UR:BYTES/1OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
                    'UR:BYTES/2OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/VM77CSD3PNN5MJLJTLQ4MQ570QCVXFTY82V9V86YRDQ2QT5R2DYNU6HUZCVJL6VAJRVV5E2NNTMHMH4VEJY58GM4VW5M4QM8T02AFKNUVRY6ZUK0D9QVHU8V3LSYZADX9XFJUDGJCHF2463UEGEYDAQ2Y8LACV7RNP7U0WYQX5FRP6EHT8LRCLW8KTF6YZ54N9HLPDAQ',
                    'UR:BYTES/3OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/MW5RF7TTADJVZN35YMAS2X5NDWJP26DTN8QQV6NDNSRH0FY7F8NVHTFY6U32F376ZYJRYEUJVJU6MS9GELUA68LQA60WYARLDF59XLPCNFES8GD0Y0ZNFMNRJ27P0VZV7RAUUA5FUE4KWWJYPSZ2J32QQKCVWENYVWG3X3VWKLGFQTHLQNG3ZWXW928WZ65U6LYFYEG5',
                    'UR:BYTES/4OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/A75MMQAW0FXP8XP47RLQ76XX9RSXGHY9YNPSMLP3F6P9574PXGJDNR3002W3YXP6NXDMRU59F8YE4YRJMXWQTSJWPJZGFRZ0C9R6P99T0D57NJL2S62JLN8325Q0HV35LLNWUMNDA4G4EQQKEVQHHGM0HYC77FMVA38DYTQ6A52FT5KL8V7WVMQR7KULL2ZRF0CW37C5',
                    'UR:BYTES/6OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/WPCUZ4DDRDT5VH7UP75P5ULE7XDVFPEQ982CGNQC8RMN96QRQSM88CNVH3D4Z2T6XF8LQZ3D94PZ9WK426UN6F7GUDMW8LU0N5MMXPE5ZPCGAWEAFHT5W0F8YY33PDC68SE6TJ8C0AZGY3JQULUFWR6WM2FKGX2US753ZU4C7ZZLZAEKG8W7RN3PJWR5VG6Q2K7FW88Z',
                    'UR:BYTES/7OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/XF0CZN37A3S00QWAF7H49T74HE9XKWR9DALFWW0HYN9HEN2WF5Q7SQ4D60W8HQCER7Y5K0HQA46JAEG56HK92XD0VZ4',
                ]);
            }).toThrow();
        });
        it('invalid piece', () => {
            expect(() => {
                decodeUR([
                    'UR:BYTES/1OF7/TEST/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
                    'UR:BYTES/2OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/VM77CSD3PNN5MJLJTLQ4MQ570QCVXFTY82V9V86YRDQ2QT5R2DYNU6HUZCVJL6VAJRVV5E2NNTMHMH4VEJY58GM4VW5M4QM8T02AFKNUVRY6ZUK0D9QVHU8V3LSYZADX9XFJUDGJCHF2463UEGEYDAQ2Y8LACV7RNP7U0WYQX5FRP6EHT8LRCLW8KTF6YZ54N9HLPDAQ',
                    'UR:BYTES/3OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/MW5RF7TTADJVZN35YMAS2X5NDWJP26DTN8QQV6NDNSRH0FY7F8NVHTFY6U32F376ZYJRYEUJVJU6MS9GELUA68LQA60WYARLDF59XLPCNFES8GD0Y0ZNFMNRJ27P0VZV7RAUUA5FUE4KWWJYPSZ2J32QQKCVWENYVWG3X3VWKLGFQTHLQNG3ZWXW928WZ65U6LYFYEG5',
                    'UR:BYTES/4OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/A75MMQAW0FXP8XP47RLQ76XX9RSXGHY9YNPSMLP3F6P9574PXGJDNR3002W3YXP6NXDMRU59F8YE4YRJMXWQTSJWPJZGFRZ0C9R6P99T0D57NJL2S62JLN8325Q0HV35LLNWUMNDA4G4EQQKEVQHHGM0HYC77FMVA38DYTQ6A52FT5KL8V7WVMQR7KULL2ZRF0CW37C5',
                    'UR:BYTES/5OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/NH55UPGT8KSH3HCLWMQQ5DNVK2QPL27LRG0FPNFU630VK75NPFQTZ529TAMTWFK42TE3CGFJFXFD5FTLLZ779Y3AL4WS66U8YVL6UG2LLT97EKTZFYYEUL35YL2N8K6KEKCFCAR4KN8RX98R8APE2WNNWZRXESGASHCQKUD325GTGMZTF7JFP3NQMHLD5R8TRWPXTX2L',
                    'UR:BYTES/6OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/WPCUZ4DDRDT5VH7UP75P5ULE7XDVFPEQ982CGNQC8RMN96QRQSM88CNVH3D4Z2T6XF8LQZ3D94PZ9WK426UN6F7GUDMW8LU0N5MMXPE5ZPCGAWEAFHT5W0F8YY33PDC68SE6TJ8C0AZGY3JQULUFWR6WM2FKGX2US753ZU4C7ZZLZAEKG8W7RN3PJWR5VG6Q2K7FW88Z',
                    'UR:BYTES/7OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/XF0CZN37A3S00QWAF7H49T74HE9XKWR9DALFWW0HYN9HEN2WF5Q7SQ4D60W8HQCER7Y5K0HQA46JAEG56HK92XD0VZ4',
                ]);
            }).toThrow();
        });
        it('invalid checksum', () => {
            expect(() => {
                decodeUR([
                    'UR:BYTES/1OF7/EYSN6US0YVJDEXN9YJKV3K7ZJHP2SUT478ZUWCVGS5CLSWPFXHM7NYFJMA/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
                    'UR:BYTES/2OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/VM77CSD3PNN5MJLJTLQ4MQ570QCVXFTY82V9V86YRDQ2QT5R2DYNU6HUZCVJL6VAJRVV5E2NNTMHMH4VEJY58GM4VW5M4QM8T02AFKNUVRY6ZUK0D9QVHU8V3LSYZADX9XFJUDGJCHF2463UEGEYDAQ2Y8LACV7RNP7U0WYQX5FRP6EHT8LRCLW8KTF6YZ54N9HLPDAQ',
                    'UR:BYTES/3OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/MW5RF7TTADJVZN35YMAS2X5NDWJP26DTN8QQV6NDNSRH0FY7F8NVHTFY6U32F376ZYJRYEUJVJU6MS9GELUA68LQA60WYARLDF59XLPCNFES8GD0Y0ZNFMNRJ27P0VZV7RAUUA5FUE4KWWJYPSZ2J32QQKCVWENYVWG3X3VWKLGFQTHLQNG3ZWXW928WZ65U6LYFYEG5',
                    'UR:BYTES/4OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/A75MMQAW0FXP8XP47RLQ76XX9RSXGHY9YNPSMLP3F6P9574PXGJDNR3002W3YXP6NXDMRU59F8YE4YRJMXWQTSJWPJZGFRZ0C9R6P99T0D57NJL2S62JLN8325Q0HV35LLNWUMNDA4G4EQQKEVQHHGM0HYC77FMVA38DYTQ6A52FT5KL8V7WVMQR7KULL2ZRF0CW37C5',
                    'UR:BYTES/5OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/NH55UPGT8KSH3HCLWMQQ5DNVK2QPL27LRG0FPNFU630VK75NPFQTZ529TAMTWFK42TE3CGFJFXFD5FTLLZ779Y3AL4WS66U8YVL6UG2LLT97EKTZFYYEUL35YL2N8K6KEKCFCAR4KN8RX98R8APE2WNNWZRXESGASHCQKUD325GTGMZTF7JFP3NQMHLD5R8TRWPXTX2L',
                    'UR:BYTES/6OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/WPCUZ4DDRDT5VH7UP75P5ULE7XDVFPEQ982CGNQC8RMN96QRQSM88CNVH3D4Z2T6XF8LQZ3D94PZ9WK426UN6F7GUDMW8LU0N5MMXPE5ZPCGAWEAFHT5W0F8YY33PDC68SE6TJ8C0AZGY3JQULUFWR6WM2FKGX2US753ZU4C7ZZLZAEKG8W7RN3PJWR5VG6Q2K7FW88Z',
                    'UR:BYTES/7OF7/0JSMW5RETZCECXHPGZ2E6PNZW9QY98M0FRAFZJUWN324W4YF8XDQ0H0CMW/XF0CZN37A3S00QWAF7H49T74HE9XKWR9DALFWW0HYN9HEN2WF5Q7SQ4D60W8HQCER7Y5K0HQA46JAEG56HK92XD0VZ4',
                ]);
            }).toThrow();
        });
    });
    describe('extract single workload', () => {
        it('should extract index and total', () => {
            expect(
                extractSingleWorkload(
                    'UR:BYTES/1OF7/EYSN6US0YVJDEXN9YJKV3K7ZJHP2SUT478ZUWCVGS5CLSWPFXHM7NYFJMA/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
                ),
            ).toStrictEqual([1, 7]);
        });
        it('small payload', () => {
            expect(
                extractSingleWorkload(
                    'UR:BYTES/EYSN6US0YVJDEXN9YJKV3K7ZJHP2SUT478ZUWCVGS5CLSWPFXHM7NYFJMA/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
                ),
            ).toStrictEqual([1, 1]);
            expect(
                extractSingleWorkload(
                    'UR:BYTES/TYPJQLJ2VYU9UF2SNQD5K43N4VTCAVRH5VZST7748UG8ASGGRE70PJ3UPHQTL6JM30A4UMLUJXHAZPXR4F6KYY94M0Z3RR739JR7UPPXNQ2M565EDZSDP5AH4XMRZWP2X678P2MZD4T8PD953LUY8AXE59TRR2N8C740PTRVUL3MLUPM9JTY8CEHTER5J0ZWP7RR2V5A',
                ),
            ).toStrictEqual([1, 1]);
        });
    });
});
